{"version":3,"names":["cov_2fi51es89t","actualCoverage","SvgValidationError","SvgRenderer","logger","SvgDocumentProcessor","renderer","constructor","f","s","processDocument","spec","startTime","Date","now","errors","warnings","document","viewBox","elements","b","width","undefined","height","title","description","validate","validation","validateDocument","push","valid","svg","render","metadata","complexity","length","features","Set","map","el","type","accessibility","hasTitle","hasDescription","compliance","processingTime","error","getProcessingStats","totalDocuments","totalProcessingTime","averageProcessingTime"],"sources":["C:\\GitHub\\Svg-Mcp-Server\\src\\core\\SvgDocumentProcessor.ts"],"sourcesContent":["/**\n * SVG Document Processor\n */\n\nimport { SvgDocument, SvgAnyElement, ViewBox, SvgValidationError } from '../types/svg.js';\nimport { SvgRenderer } from './SvgRenderer.js';\nimport { logger } from '../utils/logger.js';\n\nexport interface SvgDocumentSpec {\n  viewBox: ViewBox;\n  elements: SvgAnyElement[];\n  width?: number;\n  height?: number;\n  title?: string;\n  description?: string;\n  optimize?: boolean;\n  validate?: boolean;\n  generateMetadata?: boolean;\n}\n\nexport interface ProcessingResult {\n  document: SvgDocument;\n  svg: string;\n  warnings: string[];\n  errors: string[];\n  metadata: DocumentMetadata;\n  processingTime: number;\n}\n\nexport interface DocumentMetadata {\n  complexity: 'low' | 'medium' | 'high';\n  features: string[];\n  accessibility: {\n    hasTitle: boolean;\n    hasDescription: boolean;\n  };\n  compliance?: string;\n}\n\nexport class SvgDocumentProcessor {\n  private readonly renderer: SvgRenderer;\n\n  constructor() {\n    this.renderer = new SvgRenderer();\n  }\n\n  async processDocument(spec: SvgDocumentSpec): Promise<ProcessingResult> {\n    const startTime = Date.now();\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    try {\n      const document: SvgDocument = {\n        viewBox: spec.viewBox,\n        elements: spec.elements,\n        ...(spec.width !== undefined && { width: spec.width }),\n        ...(spec.height !== undefined && { height: spec.height }),\n        ...(spec.title && { title: spec.title }),\n        ...(spec.description && { description: spec.description })\n      };\n\n      if (spec.validate !== false) {\n        const validation = await this.validateDocument(document);\n        errors.push(...validation.errors);\n        warnings.push(...validation.warnings);\n        \n        if (!validation.valid) {\n          throw new SvgValidationError('Document validation failed', { errors, warnings });\n        }\n      }\n\n      const svg = await this.renderer.render(document);\n      \n      const metadata: DocumentMetadata = {\n        complexity: document.elements.length < 10 ? 'low' : document.elements.length < 100 ? 'medium' : 'high',\n        features: [...new Set(document.elements.map(el => el.type))],\n        accessibility: {\n          hasTitle: !!document.title,\n          hasDescription: !!document.description\n        },\n        compliance: 'svg20'\n      };\n\n      const processingTime = Date.now() - startTime;\n\n      return { document, svg, warnings, errors, metadata, processingTime };\n\n    } catch (error) {\n      logger.error('Document processing failed', { error, spec });\n      throw error;\n    }\n  }\n\n  async validateDocument(document: SvgDocument): Promise<{\n    valid: boolean;\n    errors: string[];\n    warnings: string[];\n  }> {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    if (document.viewBox.width <= 0) {\n      errors.push('ViewBox width must be positive');\n    }\n    if (document.viewBox.height <= 0) {\n      errors.push('ViewBox height must be positive');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  getProcessingStats(): {\n    totalDocuments: number;\n    totalProcessingTime: number;\n    averageProcessingTime: number;\n  } {\n    // Simple stats for now\n    return {\n      totalDocuments: 0,\n      totalProcessingTime: 0,\n      averageProcessingTime: 0\n    };\n  }\n}\n"],"mappings":"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","ignoreList":[]}